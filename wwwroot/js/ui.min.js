/* Enable Bootstrap Popover */

$(document).ready(function () {
    updateColorPalletPreview();
    updateCanvasSize();
});

$(function () {
    $('[data-toggle="popover"]').popover()
})

/* update canvas */

$(window).resize(function () {
    updateCanvasSize();
});

function updateCanvasSize() {
    setTimeout(function () {
        $('#canvasWrapper>canvas').attr('height', $('#canvasWrapper>canvas').height());
        $('#canvasWrapper>canvas').attr('width', $('#canvasWrapper>canvas').width());
        redraw(remoteDrawingHistory);
        redraw(localDrawingHistory);
    }, 10);
};

/* Image overlay */

function addImageOverlay() {
    $('.overlay-img').attr('src', $('#imageOverlayLink').val());
}

function removeImageOverlay() {
    $('.overlay-img').attr('src', '');
}

/* Toolbar Item Active Handler */

$('.toolbar-item').click(function () {
    if ($('.toolbar-item.active').length) {
        $('.toolbar-item.active').removeClass('active');
    }
    $(this).addClass('active');
    $('.popover').remove();
});

$('.toolbar-item').mouseleave(function () {
    if ($(this).hasClass('active')) {
        $(this).removeClass('active');
    }
});

/* Color Pallet */

$('.pallet-color').click(function () {
    updateColorPalletPreview();
});

function updateColorPalletPreview() { /* if black color -> white, rest -> black */
    $('.color-selector').css('background-color', selectedColor);
    if (selectedColor == '#000' || selectedColor == '#000000') {
        $('.color-selector>i').css('color', '#fff');
    } else {
        $('.color-selector>i').css('color', '#000');
    }
}

/* Pen Size */

$('.stroke-increase').click(function () {
    if (selectedSize < 10) {
        setStrokeSize(selectedSize + 1);
        $('.current-stroke-size').html(selectedSize);
    }
});

$('.stroke-decrease').click(function () {
    if (selectedSize > 1) {
        setStrokeSize(selectedSize - 1);
        $('.current-stroke-size').html(selectedSize);
    }
});